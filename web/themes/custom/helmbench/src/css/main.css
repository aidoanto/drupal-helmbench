/**
 * Main CSS Entry Point
 *
 * This file is processed by Tailwind CSS to generate dist/css/main.css.
 * Run: npm run build (or npm run dev for watch mode)
 */

/* Tailwind Base - CSS reset and base styles */
@tailwind base;

/* Tailwind Components - Component classes */
@tailwind components;

/* Tailwind Utilities - Utility classes */
@tailwind utilities;

/**
 * Custom Base Styles
 * Add global styles that apply to bare HTML elements.
 * Use @layer base to ensure proper ordering with Tailwind's reset.
 */
@layer base {

  :root {
    /* Store only the OKLCH components (L C H) - not the full oklch() function.
     * LCH = Lightness, Chroma, Hue.
     * This allows Tailwind to inject opacity via the /<alpha-value> syntax.
     * Example: bg-bg/80 becomes oklch(0.96 0.02 79 / 0.8)
     */
    --bg-deep: 0.85 0.025 79;
    /* oklch(0.85 0.025 79) */
    --bg: 0.96 0.02 79;
    /* oklch(0.96 0.02 79) */
    --bg-shallow: 1 0.02 79;
    /* oklch(1 0.02 79) */
    --bg-alternate: 0.9 0.04 79;
    /* oklch(0.9 0.025 79) */
    --text: 0.15 0.04 79;
    /* oklch(0.15 0.04 79) */
    --text-muted: 0.4 0.04 79;
    /* oklch(0.4 0.04 79) */
    --highlight: 1 0.04 79;
    /* oklch(1 0.04 79) */
    --border: 0.6 0.04 79;
    /* oklch(0.6 0.04 79) */
    --border-muted: 0.7 0.04 79;
    /* oklch(0.7 0.04 79) */
    --primary: 0.4 0.1 79;
    /* oklch(0.4 0.1 79) */
    --secondary: 0.4 0.1 259;
    /* oklch(0.4 0.1 259) */
    --danger: 0.5 0.05 30;
    /* oklch(0.5 0.05 30) */
    --warning: 0.5 0.05 100;
    /* oklch(0.5 0.05 100) */
    --success: 0.5 0.05 160;
    /* oklch(0.5 0.05 160) */
    --info: 0.5 0.05 260;
    /* oklch(0.5 0.05 260) */
  }

  .dark {
    /* Dark mode values - darker colors */
    --bg-deep: 0.1 0.02 79;
    /* oklch(0.1 0.02 79) */
    --bg: 0.15 0.02 79;
    /* oklch(0.15 0.02 79) */
    --bg-shallow: 0.25 0.02 79;
    /* oklch(0.25 0.02 79) */
    --bg-alternate: 0.28 0.03 79;
    /* oklch(0.28 0.03 79) */
    --text: 0.96 0.04 79;
    /* oklch(0.96 0.04 79) */
    --text-muted: 0.76 0.04 79;
    /* oklch(0.76 0.04 79) */
    --highlight: 0.5 0.04 79;
    /* oklch(0.5 0.04 79) */
    --border: 0.4 0.04 79;
    /* oklch(0.4 0.04 79) */
    --border-muted: 0.3 0.04 79;
    /* oklch(0.3 0.04 79) */
    --primary: 0.76 0.1 79;
    /* oklch(0.76 0.1 79) */
    --secondary: 0.76 0.1 259;
    /* oklch(0.76 0.1 259) */
    --danger: 0.7 0.05 30;
    /* oklch(0.7 0.05 30) */
    --warning: 0.7 0.05 100;
    /* oklch(0.7 0.05 100) */
    --success: 0.7 0.05 160;
    /* oklch(0.7 0.05 160) */
    --info: 0.7 0.05 260;
    /* oklch(0.7 0.05 260) */
  }

  html {
    font-size: 16px;
  }

  body {
    @apply text-text font-sans leading-relaxed;
    /* Background gradient moved to .page-wrapper::before for fixed positioning */
    min-height: 100vh;
  }

  /* Fixed gradient background that doesn't scroll with content */
  .page-wrapper::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: linear-gradient(180deg, oklch(var(--bg-deep)), oklch(var(--bg-shallow)));
    z-index: -1; /* Keep it behind all content */
  }

  /* All typography styling is now centralized in the prose class
   * configured in tailwind.config.js. Apply the prose class to
   * content areas that need styled HTML elements.
   */
}

/**
 * Custom Components
 * Reusable component patterns. Use @apply to compose Tailwind utilities.
 */
@layer components {
  /* ==========================================================================
   * Accordion Component
   * ========================================================================== */
  .accordion summary {
    list-style: none;
  }
  .accordion[open] .icon-container {
    transform: rotate(180deg);
  }

  /* ==========================================================================
   * Mobile Navigation Drawer
   * Slide-in drawer from the right with overlay
   * ========================================================================== */
  .mobile-nav-overlay {
    @apply fixed inset-0 bg-black/50 z-40;
    @apply opacity-0 pointer-events-none;
    @apply transition-opacity duration-300 ease-in-out;
  }
  .mobile-nav-overlay.is-open {
    @apply opacity-100 pointer-events-auto;
  }

  .mobile-nav-drawer {
    @apply fixed inset-y-0 right-0 w-72 max-w-[80vw] bg-bg z-50;
    @apply transform translate-x-full;
    @apply transition-transform duration-300 ease-in-out;
    @apply shadow-2xl;
  }
  .mobile-nav-drawer.is-open {
    @apply translate-x-0;
  }

  /* Nav items in mobile drawer - active/inactive styling */
  .mobile-nav__list a {
    @apply block py-2 transition-all duration-200;
  }
  .mobile-nav__list a.is-active {
    @apply text-lg font-medium;
  }
  .mobile-nav__list a:not(.is-active) {
    @apply text-sm opacity-50;
  }

  /* ==========================================================================
   * Mobile Sticky TOC Header
   * Shows current section, expands to show full TOC list
   * ========================================================================== */
  .sticky-toc__trigger {
    @apply cursor-pointer;
  }
  
  /* Rotate chevron when dropdown is open (chevron-up rotates to point down) */
  .sticky-toc__trigger[aria-expanded="true"] .sticky-toc__icon-container {
    transform: rotate(180deg);
  }

  .sticky-toc__dropdown {
    @apply absolute left-0 right-0 bg-bg;
    @apply shadow-lg border-b border-border-muted;
    @apply max-h-[60vh] overflow-y-auto;
    @apply transition-all duration-200 ease-in-out;
  }
  
  /* Hide placeholder text once JS has loaded the current section */
  .sticky-toc__current:not(:empty) .sticky-toc__placeholder {
    @apply hidden;
  }

  /* TOC list in mobile dropdown - built by JavaScript */
  .sticky-toc__list {
    @apply list-none p-0 m-0;
  }
  
  .sticky-toc__list li {
    @apply list-none;
  }
  
  /* TOC links - default styling (inactive) */
  .sticky-toc__list .toc-link {
    @apply text-secondary;
  }
  
  /* H1 link always in primary color */
  .sticky-toc__list .toc-link--h1 {
    @apply text-primary;
  }
  
  /* Active link - larger text, full opacity */
  .sticky-toc__list .toc-link.is-active {
    @apply text-lg opacity-100;
  }
  
  /* Inactive links - smaller text, 50% opacity */
  .sticky-toc__list .toc-link:not(.is-active) {
    @apply text-sm opacity-50;
  }
  
  /* But H1 is always fully visible even when inactive */
  .sticky-toc__list .toc-link--h1:not(.is-active) {
    @apply opacity-100;
  }

  /* ==========================================================================
   * Desktop TOC Sidebar
   * Dynamically built from page headings, same as mobile
   * ========================================================================== */
  
  /* Desktop TOC list styling */
  .region-toc ul {
    @apply list-none p-0 m-0;
  }
  
  .region-toc li {
    @apply list-none;
  }

  /* TOC links - base styling */
  .region-toc .toc-link {
    @apply block py-2 transition-all duration-200 text-secondary;
  }
  
  /* H1 link always in primary color */
  .region-toc .toc-link--h1 {
    @apply text-primary;
  }

  /* Active state - larger, full opacity */
  .region-toc .toc-link.is-active {
    @apply text-lg opacity-100;
  }
  
  /* Inactive state - smaller, 50% opacity */
  .region-toc .toc-link:not(.is-active) {
    @apply text-sm opacity-50;
  }
  
  /* H1 always visible even when inactive */
  .region-toc .toc-link--h1:not(.is-active) {
    @apply opacity-100;
  }

  /* ==========================================================================
   * Desktop Navigation Sidebar
   * Active/inactive styling for nav items
   * ========================================================================== */
  .region-navigation a {
    @apply block py-1 transition-all duration-200;
  }
  
  /* Active page - larger, full opacity */
  .region-navigation a.is-active,
  .region-navigation a.is-active-trail {
    @apply text-base font-medium opacity-100;
  }
  
  /* Inactive pages - smaller, 50% opacity */
  .region-navigation a:not(.is-active):not(.is-active-trail) {
    @apply text-sm opacity-50;
  }

  /* ==========================================================================
   * TOC Filter Module - Hide unwanted features
   * The TOC Filter module forces a title and back-to-top links even when
   * settings are empty. Hide them with CSS since the module won't let us
   * disable them properly.
   * ========================================================================== */
  
  /* Hide the "Table of contents" title - it's generated by the block not the module */
  #block-helmbench-tableofcontents > h2,
  .region-toc > div > div > h2 {
    @apply hidden;
  }
  
  /* Hide the "Back to top" links */
  .toc-back-to-top,
  a[href="#top"],
  a[class*="back-to-top"],
  .back-to-top {
    @apply hidden;
  }

  /* ==========================================================================
   * Content Width Grid - Variable Width Layout
   * Allows content to be regular (70ch) or wide (90ch) on desktop/tablet.
   * On mobile, everything is full-width.
   * ========================================================================== */
  
  /* Content grid with named lines - desktop and tablet only */
  @screen md {
    .content-grid {
      --content-width: 70ch;
      --wide-width: 90ch;
      
      display: grid;
      grid-template-columns:
        [full-start] 1fr
        [wide-start] minmax(0, calc((var(--wide-width) - var(--content-width)) / 2))
        [content-start] min(100% - 2rem, var(--content-width))
        [content-end] minmax(0, calc((var(--wide-width) - var(--content-width)) / 2))
        [wide-end] 1fr
        [full-end];
    }

    /* All direct children default to content width */
    .content-grid > * {
      grid-column: content;
    }

    /* Wide variant spans the wide track */
    .content-grid > .width-wide {
      grid-column: wide;
    }
  }
}

/**
 * Custom Utilities
 * One-off utility classes that don't fit Tailwind's defaults.
 */
@layer utilities {
  /* TODO: Add custom utilities if needed */
  /* Example:
  .text-balance {
    text-wrap: balance;
  }
  */
}